<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>[no-dogma] HUB</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <div id="outer_main">
        <div id="side_panel">
            <div id="app_title">
                [no-dogma] HUB
                <div id="app_subtitle">share haxor content</div>
                <div id="options">
                    <div onclick="swapScreens('software')" class="option">software</div>
                    <div onclick="swapScreens('diagnostic')" class="option">diagnostics</div>
                    <div onclick="swapScreens('configure')" class="option">configure wifi</div>
                </div>
            </div>
        </div>
        <div id="main_body" />
    </div>
</body>


<script>
    // data ////////////////////////
    const getAvailableSoftware = () => new Promise((resolve, reject) => {
       fetch('/software').then(response => {
           response.json().then(resolve).catch(reject);
       }).catch(reject);
    });
    const setSoftwareAsActive = () => new Promise((resolve, reject) => {

    });
    //////////////////////////////

    const createSimpleElement = (header, subtitle) => {
        const networkElement = document.createElement('div');
        networkElement.className = 'status_title';
        networkElement.append(header);

        const statusSubtitleElement = document.createElement('div');
        statusSubtitleElement.className = 'status_subtitle';
        statusSubtitleElement.innerText = subtitle;
        networkElement.append(statusSubtitleElement);
        return networkElement;
    };
    const createTitle = title => {
        const titleElement = document.createElement('div');
        titleElement.id = 'main_body_title';
        titleElement.innerText = title;
        return titleElement;
    };

    const createSoftwareElements = softwareElement => {
        const element = document.createElement('div');
        element.className = 'available_sw';
        element.innerText =  softwareElement.name;
        element.style = `background: ${softwareElement.imageUrl}; background-size: cover;`;
        return element;
    };
    const addSoftware = software => {
        const main_sw = document.createElement('div');
        main_sw.id = 'main_body_sw';
        main_sw.innerText = '';
        const elements = software.map(createSoftwareElements);
        elements.forEach(element => {
           main_sw.appendChild(element);
        });
        return main_sw;
    };

    const swapToSoftwareScreen = software => {
        const element = document.querySelector('#main_body');
        element.innerText = '';
        element.append(createTitle('Software'));
        const addSoftwareElements = addSoftware(software);
        element.append(addSoftwareElements);
    };
    const swapToDiagnostics = () => {
        const element = document.querySelector('#main_body');
        element.innerText = '';
        element.append(createTitle('Diagnostics'));
        element.append(createSimpleElement('Installed Software', 'automate'));
        element.append(createSimpleElement('Software Container', 'dockerhub.com/BradfordMedeiros/automate_core_arm_0.7.0'));
        element.append(createSimpleElement('Installed Software', 'automate'));

    };

    const swapToConfigure = () => {
        const element = document.querySelector('#main_body');
        element.innerText = '';
        element.append(createTitle('Configure'));
        element.append(createSimpleElement('Is Connected to a Network', 'false'));
        element.append(createSimpleElement('Is Connected to Internet', 'false'));
    };


    const screenToDrawMap = {
      software: () => {
          getAvailableSoftware().then(software => {
              swapToSoftwareScreen(software);
          });
      },
      diagnostic: swapToDiagnostics,
      configure: swapToConfigure,
    };

    const swapScreens = screen => {
        const drawScreen = screenToDrawMap[screen];
        drawScreen();
    };

    swapScreens('software');

</script>
</html>




